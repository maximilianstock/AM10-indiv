---
title: "Problem Set 2"
author: "Maximilian Stock"
date: "13/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(vroom)
library(tidyverse)
library(scales)  #for transparency
library(lubridate)
library(ggExtra)
library(plyr)
```


```{r}
source <- "data/stop-search"
```

```{r}
files <- fs::dir_ls(path = source, regexp = "\\.csv$", recurse = TRUE)
```

```{r}
stop_search_data <- vroom(files, id = "source")
```

```{r}
# plot1Data <- stop_search_data %>%
#   select(-source, c("Object of search", "Date")) %>%
#   drop_na(`Object of search`) %>%
#   mutate("month" = month(Date)) %>%
#   
#   group_by(`Object of search`, month) %>%
#   dplyr::summarise(count = n()) %>% 
#   ddply(.(`Object of search`), transform, rescale = rescale(count)) %>% 
#   select(-"Object.of.search") %>% 
# 
# 
# 
#   ggplot(aes(x = month, y = `Object of search`))+
#     geom_tile(aes(fill = rescale))
# 
# plot1Data
```

```{r}
plot1Data <- stop_search_data %>%
  sele

```






